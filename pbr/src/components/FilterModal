import * as React from "react";

import { Button, Stack } from "@mui/material";
import CloseIcon from "@mui/icons-material/Close";
import SampleIcon from "@mui/icons-material/Science";
import NextIcon from "@mui/icons-material/ArrowForwardIos";
import PrevIcon from "@mui/icons-material/ArrowBackIos";
import SubmitIcon from "@mui/icons-material/Publish";
import FilterListIcon from "@mui/icons-material/FilterList";

import AddSample from "./AddSample";
import YourSample from "./YourSample";
import Success from "./Success";
import Error from "./Error";

import DataViewConsumer from "../../services/useDataView";
import DataViewFilterContent from "./DVFilterContent";

import CustomDialog from "../CustomDialog";
import { makeStyles } from "@mui/styles";

const useStyles = makeStyles({});

export default function DataViewFilterModal() {
  const {
    generalFilterState,
    setGeneralFilterState,
    openFilterModal, 
    setOpenFilterModal,
    handleOpenFilterModal,
    handleCloseFilterModal  
  } = DataViewConsumer();

  const classes = useStyles();
  const theme = useTheme();

  let applyFilter = async () => {
    fetch(`/api/sample/filter`, {      method: "POST",
       body: generalFilterState,})
      .then((response) => {
        return response.json();
      }).then((data) => {
        console.log(data);
        setRowList(data.row);
        setHeadCellList(data.types);
      })
      console.log("Filtering!");
      handleCloseFilterModal();
    };

  // Define the footer for the modal. By default, there's no footer.
  let footer = null;
  footer = (
    <>
    <Button
      variant="contained"
      color="secondaryLight"
      onClick={handleCloseFilterModal}
    >
      Cancel
    </Button>
    <Button
      onClick={applyFilter}
      variant="contained"
      autoFocus
    >
      Apply
    </Button>
  </>
  )

  return (
    <>
      <CustomDialog
        open={openFilterModal}
        icon={<FilterListIcon />}
        title="Data View"
        subtitle="Filter Settings"
        handleClose={handleCloseFilterModal}
        footer={footer}
      >
        <DataViewFilterContent />
      </CustomDialog>
    </>
  );
}
